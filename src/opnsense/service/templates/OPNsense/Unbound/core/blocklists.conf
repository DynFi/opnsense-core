{%
  set predefined = {
	"adu":"http://packages.dynfi.com/blocklist/adult.txt",
	"adv":"http://packages.dynfi.com/blocklist/advertise.txt",
	"agg":"http://packages.dynfi.com/blocklist/aggressive.txt",
	"alc":"http://packages.dynfi.com/blocklist/alcohol.txt",
	"ban":"http://packages.dynfi.com/blocklist/bank.txt",
	"blo":"http://packages.dynfi.com/blocklist/blog.txt",
	"cel":"http://packages.dynfi.com/blocklist/celebrity.txt",
	"cha":"http://packages.dynfi.com/blocklist/chat.txt",
	"coo":"http://packages.dynfi.com/blocklist/cooking.txt",
	"cry":"http://packages.dynfi.com/blocklist/crypto.txt",
	"cry":"http://packages.dynfi.com/blocklist/cryptocurrency.txt",
	"dan":"http://packages.dynfi.com/blocklist/dangerous_material.txt",
	"dat":"http://packages.dynfi.com/blocklist/dating.txt",
	"doh":"http://packages.dynfi.com/blocklist/doh.txt",
	"dru":"http://packages.dynfi.com/blocklist/drugs.txt",
	"edu":"http://packages.dynfi.com/blocklist/education.txt",
	"fil":"http://packages.dynfi.com/blocklist/filter_bypass.txt",
	"fin":"http://packages.dynfi.com/blocklist/finance.txt",
	"for":"http://packages.dynfi.com/blocklist/fortunetelling.txt",
	"for":"http://packages.dynfi.com/blocklist/forum.txt",
	"fr":"http://packages.dynfi.com/blocklist/fr_exam_cheaters.txt",
	"fra":"http://packages.dynfi.com/blocklist/fraud.txt",
	"gam":"http://packages.dynfi.com/blocklist/gamble.txt",
	"gam":"http://packages.dynfi.com/blocklist/gambling.txt",
	"gam":"http://packages.dynfi.com/blocklist/games.txt",
	"gov":"http://packages.dynfi.com/blocklist/government.txt",
	"hac":"http://packages.dynfi.com/blocklist/hacking.txt",
	"hom":"http://packages.dynfi.com/blocklist/homestyle.txt",
	"hos":"http://packages.dynfi.com/blocklist/hospitals.txt",
	"ima":"http://packages.dynfi.com/blocklist/imagehosting.txt",
	"isp":"http://packages.dynfi.com/blocklist/isp.txt",
	"job":"http://packages.dynfi.com/blocklist/jobsearch.txt",
	"lib":"http://packages.dynfi.com/blocklist/library.txt",
	"lin":"http://packages.dynfi.com/blocklist/lingerie.txt",
	"mal":"http://packages.dynfi.com/blocklist/malware.txt",
	"man":"http://packages.dynfi.com/blocklist/manga.txt",
	"mil":"http://packages.dynfi.com/blocklist/military.txt",
	"mov":"http://packages.dynfi.com/blocklist/movies.txt",
	"mus":"http://packages.dynfi.com/blocklist/music.txt",
	"new":"http://packages.dynfi.com/blocklist/new.txt",
	"new":"http://packages.dynfi.com/blocklist/news.txt",
	"pho":"http://packages.dynfi.com/blocklist/phone.txt",
	"pir":"http://packages.dynfi.com/blocklist/piracy.txt",
	"pod":"http://packages.dynfi.com/blocklist/podcasts.txt",
	"pol":"http://packages.dynfi.com/blocklist/politics.txt",
	"por":"http://packages.dynfi.com/blocklist/porn.txt",
	"pri":"http://packages.dynfi.com/blocklist/privacy.txt",
	"rad":"http://packages.dynfi.com/blocklist/radio.txt",
	"rea":"http://packages.dynfi.com/blocklist/reaffected.txt",
	"red":"http://packages.dynfi.com/blocklist/redirector.txt",
	"rel":"http://packages.dynfi.com/blocklist/religion.txt",
	"rem":"http://packages.dynfi.com/blocklist/remote_control.txt",
	"rin":"http://packages.dynfi.com/blocklist/ringtones.txt",
	"sci":"http://packages.dynfi.com/blocklist/science.txt",
	"sea":"http://packages.dynfi.com/blocklist/search_engnines.txt",
	"sex":"http://packages.dynfi.com/blocklist/sexual_education.txt",
	"sho":"http://packages.dynfi.com/blocklist/shopping.txt",
	"soc":"http://packages.dynfi.com/blocklist/social_media.txt",
	"spo":"http://packages.dynfi.com/blocklist/sports.txt",
	"sta":"http://packages.dynfi.com/blocklist/stalkerware.txt",
	"tra":"http://packages.dynfi.com/blocklist/translation.txt",
	"url":"http://packages.dynfi.com/blocklist/urlshortener.txt",
	"vid":"http://packages.dynfi.com/blocklist/video.txt",
	"vpn":"http://packages.dynfi.com/blocklist/vpn.txt",
	"wea":"http://packages.dynfi.com/blocklist/weapons.txt",
	"web":"http://packages.dynfi.com/blocklist/webmail.txt"
  }
%}
{%  if not helpers.empty('OPNsense.unboundplus.dnsbl.enabled') %}
[blocklists]
{%    if not helpers.empty('OPNsense.unboundplus.dnsbl.type') %}
{%      for shortcode in OPNsense.unboundplus.dnsbl.type.split(',') %}
{%        if shortcode in predefined %}
predefined_{{ shortcode }}={{ predefined[shortcode] }}
{%        else %}
#shortcode=##not_found##
{%        endif %}
{%      endfor %}
{%    endif %}
{%    if not helpers.empty('OPNsense.unboundplus.dnsbl.lists') %}
{%      for uri in OPNsense.unboundplus.dnsbl.lists.split(',') %}
custom_{{loop.index}}={{uri}}
{%      endfor %}
{%    endif %}

[exclude]
# exclude localhost entries
default_pattern_1=.*localhost$
# exclude non domain entries
default_pattern_2=^(?![a-zA-Z_\d]).*
{%    if not helpers.empty('OPNsense.unboundplus.dnsbl.whitelists')%}
# user defined
{%      for pattern in OPNsense.unboundplus.dnsbl.whitelists.split(',') %}
custom_pattern_{{loop.index}}={{ pattern }}
{%      endfor %}
{%    endif %}

{%  endif %}
