
{#
  parse all active captive portal zones and create redirect rules where transparant mode is enabled
#}
{% for cp_zone in cp_interface_list %}
{% if cp_zone.obj.transparantHTTPProxy|default('0') == '1' %}
# HTTP redirect {{ cp_zone.zone }}
ipfw add 65532 fwd 127.0.0.1,{{ OPNsense.proxy.forward.port }} tcp from any to any dst-port 80 via {{ cp_zone.if }}
{% endif %}
{% if cp_zone.obj.transparantHTTPSProxy|default('0') == '1' %}
# HTTPS redirect {{ cp_zone.zone }}
ipfw add 65532 fwd 127.0.0.1,{{ OPNsense.proxy.forward.sslbumpport }} tcp from any to any dst-port 443 via {{ cp_zone.if }}
{% endif %}
{% endfor %}
